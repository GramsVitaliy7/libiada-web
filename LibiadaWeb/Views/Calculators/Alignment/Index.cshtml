@using LibiadaWeb.Helpers
@model dynamic

@{
    ViewBag.Title = "Выравнивание генов";
}

<h2>Выравнивание генов</h2>

<script type="text/javascript">
    "use strict";

    var app = angular.module('Alignment', []);

    app.controller('AlignmentCtrl', [
        '$scope', function($scope) {

            var data = @Html.Raw(Json.Encode(ViewBag.data));

            MapModelFromJson($scope, data);

            $scope.characteristic = {
                characteristicType: $scope.characteristicTypes[0],
                link: $scope.links[0],
                notation: $scope.notations[0]
            };

            $scope.isLinkable = function(characteristic) {
                return characteristic.characteristicType.Linkable;
            };
        }
    ]);
</script>

@using (Html.BeginForm("Index", "Alignment", FormMethod.Post, new { enctype = "multipart/form-data", data_ng_app = "Alignment" }))
{
    <fieldset ng-controller="AlignmentCtrl">
        <legend>Характеристики цепочек</legend>

        <div ng-repeat="pieceTypeCheckBox in pieceTypesCheckBoxes">
            <input type="checkbox" name="pieceTypeIds" ng-value="pieceTypeCheckBox.Value"/>
            <span ng-bind="pieceTypeCheckBox.Text"></span>
        </div>

        <table class="table">
            <thead>
            <tr>
                <th>Название</th>
                <th>Описание</th>
                <th>Создан</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="matter in matters">
                <td>
                    <input type="radio" name="matterId1" ng-value="matter.Value"/>
                    <span ng-bind="matter.Text"></span>
                </td>
                <td ng-bind="matter.description"/>
                <td ng-bind="matter.created"/>
            </tr>
            </tbody>
        </table>

        <table class="table">
            <thead>
            <tr>
                <th>Название</th>
                <th>Описание</th>
                <th>Создан</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="matter in matters">
                <td>
                    <input type="radio" name="matterId2" ng-value="matter.Value"/>
                    <span ng-bind="matter.Text"></span>
                </td>
                <td ng-bind="matter.description"/>
                <td ng-bind="matter.created"/>
            </tr>
            </tbody>
        </table>
        <br/>
        <div>Способ сравнения при выравнивании:</div>
        <div>
            <input type="radio" name="validationType" value="Equality"/>
            <span> Степень совпадения</span>
        </div>
        <div>
            <input type="radio" name="validationType" value="Difference"/>
            <span> Степень расхождения</span>
        </div>
        <div>
            <input type="radio" name="validationType" value="NormalizedDifference"/>
            <span> Нормализованная степень расхождения</span>
        </div>
        <br/>
        <select title="Характеристика" ng-model="characteristic.characteristicType" ng-options="c.Text for c in characteristicTypes"></select>
        <input type="hidden" name="characteristicId" ng-value="characteristic.characteristicType.Value"/>

        <select title="Привязка" ng-show="isLinkable(characteristic)" ng-model="characteristic.link" ng-options="l.Text for l in links"></select>
        <input type="hidden" name="linkId" ng-value="characteristic.link.Value"/>

        <select title="Форма записи" ng-model="characteristic.notation" ng-options="n.Text for n in notations"></select>
        <input type="hidden" name="notationId" ng-value="characteristic.notation.Value"/>
        <br/>
        <br/>
        <input type="submit" value="Вычислить"/>
    </fieldset>
}
@section Scripts {
    @Scripts.Render("~/bundles/angularjs")
    @Scripts.Render("~/bundles/procedures")
}