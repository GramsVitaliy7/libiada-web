@using LibiadaWeb.Helpers
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    @{
        ViewBag.Title = "Subsequences characteristics distributions";
    }
    <title>@ViewBag.Title - FOA Research Lab</title>
    @Styles.Render("~/Content/css")
    @Styles.Render("~/Content/genesMap")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/angularjs")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/d3js")
    @Scripts.Render("~/bundles/plotlyjs")

</head>
<body>


    @*<h2>@ViewBag.Title</h2>*@

    @if (ViewBag.Error == null)
    {
        <div ng-app="libiada">

            @Html.Partial("_AngularControllerInitializer", "SubsequencesDistributionResultPlotlyController")
            @Scripts.Render("~/bundles/loadingWindow")
            <div class="form-horizontal" ng-controller="SubsequencesDistributionResultPlotlyCtrl">
                <loading-window loading="loading" loading-screen-header="loadingScreenHeader"></loading-window>
                <div ng-disabled="loading" ng-cloack>

                    <div id="main">
                        <div id="chart" class="responsive-chart">
                        </div>
                    </div>
                    <div id="dragbar" @*ng-mousedown="dragbarMouseDown($event)"*@></div>
                    <div id="sidebar">
                        <ul class="nav nav-tabs">
                            <li role="presentation">
                                <a ng-click="$scope.tab='Legend'" href="#">
                                    <big>
                                        <span class="glyphicon glyphicon-list" title="Legend" aria-label="Legend" aria-hidden="true"></span>
                                    </big>
                                </a>
                            </li>
                            <li role="presentation">
                                <a ng-click="$scope.tab='Characteristic'" href="#">
                                    <big>
                                        <span class="glyphicon glyphicon-equalizer" title="Display settings" aria-label="Display settings" aria-hidden="true"></span>
                                    </big>
                                </a>
                            </li>
                            <li role="presentation">
                                <a ng-click="$scope.tab='Similar sequences'" href="#">
                                    <big>
                                        <span class="glyphicon glyphicon-link" title="Similar sequences" aria-label="Similar sequences" aria-hidden="true"></span>
                                    </big>
                                </a>
                            </li>
                            <li role="presentation">
                                <a ng-click="$scope.tab='Filter'" href="#">
                                    <big>
                                        <span class="glyphicon glyphicon-search" title="Find by product" aria-label="Find by product" aria-hidden="true"></span>
                                    </big>
                                </a>
                            </li>
                            <li role="presentation">
                                <a ng-click="$scope.tab='Features'" href="#">
                                    <big>
                                        <span class="glyphicon glyphicon-filter" title="Features select" aria-label="Features select" aria-hidden="true"></span>
                                    </big>
                                </a>
                            </li>
                            <li role="presentation" ng-show="$scope.tooltipVisible">
                                <a ng-click="$scope.tab='Tooltip'" href="#">
                                    <big>
                                        <span class="glyphicon glyphicon-info-sign" title="Tooltip" aria-label="Tooltip" aria-hidden="true"></span>
                                    </big>
                                </a>
                            </li>
                        </ul>
                        <div ng-switch="$scope.tab">
                            <div ng-switch-when="Legend">

                            </div>
                            <div ng-switch-when="Characteristic">
                                <br />
                                <div class="form-group">
                                    <label class="control-label col-md-2" for="subsequenceCharacteristic">Second characteristic:</label>
                                    <div class="col-md-10">
                                        <select class="form-control" title="Subsequnce characteristic" ng-model="subsequenceCharacteristic" ng-options="c.Text for c in subsequencesCharacteristicsList" id="subsequenceCharacteristic"></select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-md-offset-2 col-md-10">
                                        <label>
                                            <input type="checkbox" name="numericXAxis" ng-model="numericXAxis" value="false" />
                                            Numeric x axis
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div ng-switch-when="Similar sequences">
                                <br />
                                <div class="form-group">
                                    <div class="col-md-offset-2 col-md-10">
                                        <label>
                                            <input type="checkbox" name="highlight" ng-model="highlight" value="false" />
                                            Highlight similar subsequences
                                        </label>
                                    </div>
                                </div>
                                <div ng-show="highlight">
                                    <div ng-repeat="characteristicComparer in characteristicComparers">
                                        <div class="form-group">
                                            <label class="control-label col-md-2" for="characteristic">Characteristic:</label>
                                            <div class="col-md-10">
                                                <select class="form-control" ng-model="characteristicComparer.characteristic" ng-options="c.Text for c in subsequencesCharacteristicsList" id="characteristic" title="Characteristic"></select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label col-md-2" for="precision">Precision of characteristic comparison:</label>
                                            <div class="col-md-10">
                                                <input class="form-control" ng-model="characteristicComparer.precision" type="number" value="0" step="any" min="0" id="precision" />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-md-offset-2 col-md-10">
                                                <button type="button" class="btn btn-danger" ng-click="deleteCharacteristicComparer(characteristicComparer)" ng-disabled="characteristicComparers.length <= 1">Delete characteristic comparer</button>
                                            </div>
                                        </div>
                                        <br />
                                    </div>
                                    <div class="form-group">
                                        <div class="col-md-offset-2 col-md-10">
                                            <button type="button" class="btn btn-success" ng-click="addCharacteristicComparer()">Add characteristic comparer</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div ng-switch-when="Filter">
                                @Html.Partial("_Filters")
                            </div>
                            <div ng-switch-when="Features">
                                @Html.Partial("_FeaturesSelect")
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
    else
    {
        if (AccountHelper.IsAdmin())
        {
            <div class="error-message">
                @Html.Raw(ViewBag.ErrorMessage)
            </div>
            <br />
            if (ViewBag.StackTrace != null)
            {
                <div class="stack-trace">
                    @Html.Raw(ViewBag.StackTrace)
                </div>
            }
        }
        else
        {
            <h1 class="text-danger">Error.</h1>
            <h2 class="text-danger">An error occurred while processing your request.</h2>

            if (ViewBag.UserError != null)
            {
                <div class="error-message">
                    @ViewBag.UserError
                </div>
            }
        }
    }
</body>
</html>