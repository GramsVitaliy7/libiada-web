@using LibiadaWeb.Helpers
@model dynamic

@{
    ViewBag.Title = "Вычисление локальных характеристик";
}

<h2>Вычисление локальных характеристик</h2>

<script type="text/javascript">

    var divCounter = 0;

    var formTable;

    $(document).ready(function() {
        formTable = $("table").dataTable({
            aLengthMenu: [[25, 50, 100, -1], [25, 50, 100, "Все"]],
            bJQueryUI: true,
            sPaginationType: "full_numbers"
        });
    
        $('form').submit(function() {
            $(formTable.fnGetHiddenNodes()).find('input:checked').attr("hidden", true).appendTo(this);
        });

        AddCharacteristic();
    });

    function AddCharacteristic() {

        var paramsList = new Object();
        
        @Helpers.FillParamsList("characteristicIds", ViewBag.characteristicsList)
        @Helpers.FillParamsList("linkUpIds",  ViewBag.linkUpsList)

        var characteristicsDiv = CreateCharacteristicsBlock(divCounter, paramsList);
        $("#characteristics_list").append(characteristicsDiv);
        divCounter++;

        return false;
    }
</script>

@using (Html.BeginForm())
{
    <table>
        <thead>
            <tr>
                <th>Название объекта
                </th>
                <th>Описание
                </th>
                <th>id
                </th>
            </tr>
        </thead>
        <tbody>
            @{
    List<MvcHtmlString> matterCheckBoxes =
        Html.CheckBoxGroup("matterIds", (List<SelectListItem>)ViewBag.matterCheckBoxes);

    for (int i = 0; i < matterCheckBoxes.Count; i++)
    {
                <tr>
                    <td>
                        @matterCheckBoxes[i]
                    </td>
                    <td>
                        @ViewBag.matters[i].description
                    </td>
                    <td>
                        @ViewBag.matters[i].id_in_remote_db
                    </td>
                </tr>
    }
            }
        </tbody>
    </table>
    <br />
    @Html.Label("Размер окна:")
    <input type="number" id="length" name="length" value="50" />
    @Html.Label("Размер шага:")
    <input type="number" id="step" name="step" value="2" />
    <br />
    <br />
    @Html.CheckBox("isDelta", "Считать разницу между характеристиками", null)
    <br />
    @Html.CheckBox("isGrowingWindow", "Считать увеличивающееся окно", null)
    <br />
    @Html.CheckBox("isFurie", "Быстрое преобразование Фурье", null)
    <br />
    @Html.CheckBox("isAutocorelation", "Вычислить авторикорреляционную функцию", null)
    <br />
    @Html.CheckBox("isMoveCoordinate", "Подвижное начало координат", null)
    <br />
  
   
    @Html.Label("Начало координат относительно блока")
    <input type="number" id="startCoordinate" name="startCoordinate" value="2" />
    <br />
    @Html.CheckBox("isSetBeginAndEnd", "Задать начало и конец цепочки", null)
    <div>
        @Html.Label("Начало:")
        <input type="number" id="beginOfChain" name="beginOfChain" value="100" />
        @Html.Label("Конец:")
        <input type="number" id="endOfChain" name="endOfChain" value="1000" />
        <br />
    </div>
    @Html.Label("Форма записи:")
    <select name="notationId">
        @foreach (var option in ViewBag.notationsList)
        {
            <option value="@option.Value">@option.Text</option>
        }
    </select>
    <br />
    @Html.Label("Язык:")
    <select name="languageId">
        @foreach (var option in ViewBag.languagesList)
        {
            <option value="@option.Value">@option.Text</option>
        }
    </select>
    <br />
    <br />
    <input type="button" onclick="AddCharacteristic()" value="Добавить характеристику" />
    <br />
    <div id="characteristics_list"></div>
    <br />
    <br />
    <input type="submit" value="Вычислить" />
}